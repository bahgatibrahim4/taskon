# 📝 نظام سندات الاستلام - Receipt Management System

## 📋 نظرة عامة

نظام متكامل لإدارة سندات استلام المواد والخدمات في مشاريع البناء. يوفر واجهة عصرية وسهلة الاستخدام مع إمكانيات البحث والفلترة والتصدير.

---

## ✨ المميزات الرئيسية

### 🎨 واجهة المستخدم
- **تصميم عصري**: واجهة احترافية بألوان متناسقة وتأثيرات انتقالية سلسة
- **Drawer Panel**: لوحة جانبية منزلقة لإنشاء وتعديل السندات
- **Responsive Design**: يعمل بكفاءة على جميع الأجهزة (ديسكتوب، تابلت، موبايل)
- **Real-time Updates**: تحديث فوري للبيانات بعد كل عملية

### 📊 إدارة السندات
- **إنشاء سند جديد**: نموذج شامل بـ 8 حقول مختلفة
- **عرض قائمة السندات**: جدول منظم بجميع السندات
- **تعديل السندات**: إمكانية تحديث أي سند موجود
- **حذف السندات**: حذف آمن مع تأكيد
- **عرض التفاصيل**: نافذة منبثقة لعرض كامل معلومات السند

### 🔍 البحث والفلترة
- **بحث سريع**: البحث في رقم السند، المستلم، المورد، والبند
- **فلتر حسب المورد**: عرض سندات مورد محدد
- **فلتر حسب نوع الخدمة**: تصنيف حسب نوع العمل
- **عداد ديناميكي**: يعرض عدد النتائج المفلترة

### 📤 التصدير
- **Excel Export**: تصدير السندات إلى ملف CSV متوافق مع Excel
- **دعم اللغة العربية**: ترميز UTF-8 مع BOM

---

## 🗂️ هيكل البيانات

### 📄 Schema السند (Receipt)

```javascript
{
  _id: ObjectId,              // معرف فريد من MongoDB
  receiptNumber: String,       // رقم السند (مثال: R-001)
  receiptDate: Date,           // تاريخ السند
  receiverName: String,        // اسم المستلم
  supplierName: String,        // اسم المورد/الجهة
  serviceType: String,         // نوع الخدمة
  itemName: String,            // البند/المادة
  quantity: String,            // الكمية
  status: String,              // الحالة
  notes: String,               // ملاحظات إضافية
  createdAt: Date,             // تاريخ الإنشاء
  updatedAt: Date              // تاريخ آخر تحديث
}
```

### 🔧 أنواع الخدمات المدعومة

| نوع الخدمة | الأيقونة | اللون |
|-----------|----------|-------|
| ⛽ ديزل | warning | أصفر |
| 🚚 نقل | info | أزرق |
| 🏗️ تأجير معدات | danger | أحمر |
| 👷 عمالة مؤقتة | success | أخضر |
| 🧱 مواد بناء | info | أزرق |
| 📦 أخرى | warning | أصفر |

### ✅ حالات السند

| الحالة | الأيقونة | اللون |
|--------|----------|-------|
| مكتمل | ✅ | أخضر |
| قيد التنفيذ | ⏳ | أزرق |
| معلق | ⏸️ | أصفر |

---

## 🔌 API Endpoints

### Base URL
```
http://localhost:4000
```

### 1️⃣ جلب جميع السندات
**GET** `/receipts`

**Response:**
```json
[
  {
    "_id": "65abc123...",
    "receiptNumber": "R-001",
    "receiptDate": "2025-10-19",
    "receiverName": "محمد أحمد",
    "supplierName": "شركة الإمداد",
    "serviceType": "ديزل",
    "itemName": "وقود ديزل",
    "quantity": "500 لتر",
    "status": "مكتمل",
    "notes": "استلام بحالة جيدة",
    "createdAt": "2025-10-19T10:00:00Z",
    "updatedAt": "2025-10-19T10:00:00Z"
  }
]
```

### 2️⃣ جلب سند محدد
**GET** `/receipts/:id`

**Response:**
```json
{
  "_id": "65abc123...",
  "receiptNumber": "R-001",
  ...
}
```

### 3️⃣ إنشاء سند جديد
**POST** `/receipts`

**Request Body:**
```json
{
  "receiptNumber": "R-002",
  "receiptDate": "2025-10-19",
  "receiverName": "علي حسن",
  "supplierName": "شركة النقل السريع",
  "serviceType": "نقل",
  "itemName": "رمل",
  "quantity": "10 متر مكعب",
  "status": "قيد التنفيذ",
  "notes": "توصيل للموقع"
}
```

**Response:**
```json
{
  "success": true,
  "id": "65abc456..."
}
```

### 4️⃣ تحديث سند
**PUT** `/receipts/:id`

**Request Body:** (نفس هيكل POST)

**Response:**
```json
{
  "success": true,
  "message": "تم تحديث السند بنجاح"
}
```

### 5️⃣ حذف سند
**DELETE** `/receipts/:id`

**Response:**
```json
{
  "success": true,
  "message": "تم حذف السند بنجاح"
}
```

### 6️⃣ تصدير السندات
**GET** `/receipts/export`

**Response:** ملف CSV

---

## 🎯 حالات الاستخدام

### 📝 مثال 1: استلام وقود ديزل

```javascript
// إنشاء سند استلام ديزل
const receipt = {
  receiptNumber: "R-D-001",
  receiptDate: "2025-10-19",
  receiverName: "أحمد محمود (مهندس الموقع)",
  supplierName: "محطة وقود الشروق",
  serviceType: "ديزل",
  itemName: "وقود ديزل - سولار",
  quantity: "1000 لتر",
  status: "مكتمل",
  notes: "استلام الكمية كاملة - السعر 12 جنيه/لتر"
};

// إرسال للـ API
fetch('http://localhost:4000/receipts', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(receipt)
});
```

### 🚚 مثال 2: استلام مواد نقل

```javascript
const receipt = {
  receiptNumber: "R-T-015",
  receiptDate: "2025-10-19",
  receiverName: "خالد سعيد",
  supplierName: "شركة النقليات الحديثة",
  serviceType: "نقل",
  itemName: "حديد تسليح - قطر 16",
  quantity: "5 طن",
  status: "مكتمل",
  notes: "تم النقل من المصنع إلى الموقع"
};
```

### 🏗️ مثال 3: تأجير معدات

```javascript
const receipt = {
  receiptNumber: "R-E-007",
  receiptDate: "2025-10-19",
  receiverName: "وليد فتحي",
  supplierName: "مكتب المعدات الثقيلة",
  serviceType: "معدات",
  itemName: "كرين 50 طن",
  quantity: "يوم واحد",
  status: "قيد التنفيذ",
  notes: "الكرين في الموقع - العودة غداً"
};
```

---

## 🔒 الأمان والتحقق

### Frontend Validation
- جميع الحقول الأساسية **required**
- التحقق من صحة التاريخ
- التحقق من عدم ترك حقول فارغة

### Backend Validation
- التحقق من صحة ObjectId عند التحديث/الحذف
- معالجة الأخطاء وإرجاع رسائل واضحة
- Logging لجميع العمليات

---

## 📱 واجهة المستخدم - Components

### 🧭 Header Bar
- **العنوان**: "سندات الاستلام" مع أيقونة 📝
- **زر إنشاء**: "➕ إنشاء سند جديد"
- **صندوق البحث**: بحث فوري مع أيقونة 🔍
- **فلاتر**: قوائم منسدلة للموردين وأنواع الخدمات

### 📊 Table View
- **عرض منظم**: 9 أعمدة (رقم السند، التاريخ، المستلم، المورد، النوع، البند، الكمية، الحالة، الإجراءات)
- **Badges ملونة**: لتمييز أنواع الخدمات والحالات
- **أزرار الإجراءات**: عرض، تعديل، حذف
- **Empty State**: رسالة ودية عند عدم وجود سندات

### 🎨 Drawer Panel
- **فتح انزلاقي**: من الجانب الأيمن
- **نموذج بالكروت**: 8 كروت منظمة مع أيقونات
- **زر حفظ**: لإنشاء أو تحديث السند
- **زر إلغاء**: لإغلاق الـ Drawer

---

## 🚀 البدء السريع

### 1. التأكد من تشغيل السيرفر
```bash
node server.js
```

### 2. فتح الصفحة
```
http://localhost:4000/receipts.html
```

### 3. إنشاء أول سند
1. اضغط على "➕ إنشاء سند جديد"
2. املأ جميع الحقول
3. اضغط "💾 حفظ السند"

---

## 📊 إحصائيات وتحليلات

### يمكن إضافة في المستقبل:
- 📈 **تحليل الإنفاق**: رسوم بيانية لتكاليف كل نوع خدمة
- 📅 **تقارير شهرية**: ملخص السندات لكل شهر
- 💰 **إجمالي القيم**: حساب التكاليف الإجمالية
- 🔔 **تنبيهات**: إشعارات للسندات المعلقة

---

## 🛠️ التقنيات المستخدمة

| التقنية | الوصف |
|---------|--------|
| **Frontend** | HTML5, CSS3, Vanilla JavaScript |
| **Backend** | Node.js + Express.js |
| **Database** | MongoDB Atlas |
| **Fonts** | Google Fonts - Cairo |
| **Design** | CSS Grid, Flexbox, CSS Variables |
| **Animations** | CSS Transitions & Keyframes |

---

## 📞 الدعم والمساعدة

في حالة وجود أي استفسارات أو مشاكل:
1. تحقق من تشغيل السيرفر على `http://localhost:4000`
2. تأكد من اتصال MongoDB
3. راجع Console للأخطاء
4. تحقق من Network Tab في متصفح

---

## 📝 ملاحظات مهمة

- ⚠️ **رقم السند**: يجب أن يكون فريداً لكل سند
- ✅ **التواريخ**: استخدم التاريخ الهجري أو الميلادي حسب احتياجك
- 💾 **الحفظ التلقائي**: لا يوجد - يجب الضغط على زر الحفظ
- 🔄 **التحديث**: الجدول يتحدث تلقائياً بعد كل عملية

---

## 🎉 تم بنجاح!

النظام جاهز للاستخدام الفوري. استمتع بإدارة سندات الاستلام بطريقة عصرية واحترافية! 🚀

---

**آخر تحديث:** 19 أكتوبر 2025
**الإصدار:** 1.0.0
